<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>

    <h2>Novefa - Barcode scanner</h2>

    <label for="lot">lot nummer:</label>
    <input type="text" id="lot" name="lot" autofocus><br><br>
    <label for="action">Action:</label>
    <input type="text" id="action" name="action"><br><br>
    <p id="message"></p>
    <p id="message2">he</p>

    <!-- Should be external -->
    <script type="text/javascript">
        var formReady = false;
        var actionField = document.getElementById("action");
        var lotField = document.getElementById("lot");
        var messageField = document.getElementById("message");


        function sendData() {
            var xmlhttp = new XMLHttpRequest();
            xmlhttp.onreadystatechange = function () {
                if (this.readyState == 4 && this.status == 200) {
                    document.getElementById("message2").innerHTML = this.responseText;
                }
            };
            xmlhttp.open("GET", "searching?lot=" + lotField.value + "&action=" + actionField.value, true);
            xmlhttp.send();
        }


        document.body.addEventListener('keyup', function (e) {
            if (e.keyCode == 13) { //dvs. enter knappen.

                if (!formReady) {
                    formReady = true;
                    actionField.focus();
                }

                else {
                    sendData();
                    console.log("form sent");
                    formReady = false;
                    lotField.focus();
                    lotField.value = "";
                    actionField.value = "";
                }

            }
        });
    </script>

</body>
</html>